  /* ---------- Base layout ---------- */
  :root {
    --bg1: #0f172a;
    /* deep navy */
    --bg2: #0b1220;
    --accent: #6ee7b7;
    --accent-2: #60a5fa;
    --glass: rgba(255, 255, 255, 0.06);
  }

  * {
    box-sizing: border-box
  }

  html,
  body {
    height: 100%;
  }

  body {
    margin: 0;
    font-family: Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
    background: radial-gradient(1200px 600px at 10% 10%, rgba(96, 165, 250, 0.08), transparent 10%),
      radial-gradient(800px 400px at 90% 90%, rgba(110, 231, 183, 0.04), transparent 10%),
      linear-gradient(180deg, var(--bg1), var(--bg2));
    color: #e6eef8;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0;
  }

  .chat-shell {
    width: 100%;
    max-width: 920px;
    height: 100vh;
    border-radius: 20px;
    overflow: hidden;
    background: linear-gradient(180deg, rgba(255, 255, 255, 0.02), rgba(255, 255, 255, 0.01));
    box-shadow: 0 10px 40px rgba(2, 6, 23, 0.7), inset 0 1px 0 rgba(255, 255, 255, 0.02);
    display: flex;
    flex-direction: column;
    border: 1px solid rgba(255, 255, 255, 0.03);
    backdrop-filter: blur(6px) saturate(120%);
  }

  /* ---------- Header with 3D/back button ---------- */
  .chat-header {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 18px 20px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.02);
    position: relative;
    background: linear-gradient(90deg, rgba(255, 255, 255, 0.02), transparent);
  }

  
  .back-btn {
    appearance: none;
    border: 0;
    padding: 10px 14px;
    border-radius: 12px;
    cursor: pointer;
    outline: none;
    background: linear-gradient(180deg, #0b1220, #0c1424);
    color: var(--accent);
    transform-style: preserve-3d;
    transition: transform .28s cubic-bezier(.2, .9, .2, 1), box-shadow .28s;
    box-shadow: 0 8px 18px rgba(2, 6, 23, 0.6), 0 2px 0 rgba(255, 255, 255, 0.02) inset;
    display: inline-grid;
    place-items: center;
    font-weight: 700;
    font-size: 18px;
    border: 1px solid rgba(96, 165, 250, 0.12);
    will-change: transform;
  }

  /* 3D hover pop + tilt */
  .back-btn:hover {
    transform: translateZ(6px) rotateX(6deg) rotateY(-6deg) translateY(-2px);
    box-shadow: 0 22px 60px rgba(96, 165, 250, 0.06), 0 6px 12px rgba(2, 6, 23, 0.6);
  }

  .back-btn:active {
    transform: translateZ(2px) rotateX(2deg);
  }

  /* subtle animated halo behind header */
  .header-halo {
    position: absolute;
    right: 10px;
    top: 0;
    bottom: 0;
    pointer-events: none;
    z-index: 0;
  }

  .halo-circle {
    width: 220px;
    height: 220px;
    border-radius: 50%;
    filter: blur(36px);
    opacity: .12;
    background: conic-gradient(from 210deg at 50% 50%, rgba(96, 165, 250, 0.18), rgba(110, 231, 183, 0.12));
    transform: translate(40px, -30px) rotate(12deg);
    animation: haloFloat 6s ease-in-out infinite;
  }

  @keyframes haloFloat {
    0% {
      transform: translate(40px, -30px) rotate(0deg);
    }

    50% {
      transform: translate(28px, -38px) rotate(12deg);
    }

    100% {
      transform: translate(40px, -30px) rotate(0deg);
    }
  }

  #chatUsername {
    margin: 0;
    font-size: 1.15rem;
    z-index: 2
  }

  /* ---------- Messages area ---------- */
  .messages {
    flex: 1;
    overflow: auto;
    padding: 22px 18px;
    display: flex;
    flex-direction: column;
    gap: 12px;
    position: relative;
    z-index: 1;
    perspective: 1200px;
  }

  /* scrollbar styling */
  .messages::-webkit-scrollbar {
    width: 10px
  }

  .messages::-webkit-scrollbar-thumb {
    background: linear-gradient(180deg, rgba(255, 255, 255, 0.06), rgba(255, 255, 255, 0.03));
    border-radius: 10px
  }

  /* Message bubbles */
  .msg-row {
    display: flex;
    align-items: flex-end;
    gap: 8px;
    max-width: 85%;
    transform-origin: left center
  }

  .msg-row.out {
    margin-left: auto;
    justify-content: flex-end;
    transform-origin: right center
  }

  .msg {
    padding: 12px 14px;
    border-radius: 14px;
    line-height: 1.25;
    font-size: 0.95rem;
    box-shadow: 0 8px 26px rgba(2, 6, 23, 0.6);
    transform-origin: center center;
    transition: transform .25s cubic-bezier(.2, .9, .2, 1), box-shadow .25s;
    will-change: transform;
    position: relative;
    backdrop-filter: blur(6px);
  }

  .msg.in {
    background: linear-gradient(180deg, rgba(255, 255, 255, 0.02), rgba(255, 255, 255, 0.01));
    border: 1px solid rgba(255, 255, 255, 0.03);
    color: #dbeafe
  }

  .msg.out {
    background: linear-gradient(180deg, #0c1630, #071126);
    border: 1px solid rgba(96, 165, 250, 0.12);
    color: var(--accent)
  }

  /* 3D hover lift on message */
  .msg:hover {
    transform: translateY(-6px) translateZ(8px) rotateX(2deg);
    box-shadow: 0 28px 64px rgba(2, 6, 23, 0.7)
  }

  .msg .meta {
    display: block;
    font-size: 0.72rem;
    opacity: .6;
    margin-top: 6px
  }

  /* pop-in animation for new messages */
  @keyframes popIn {
    0% {
      opacity: 0;
      transform: translateY(18px) scale(.96) rotateX(8deg)
    }

    60% {
      opacity: 1;
      transform: translateY(-6px) scale(1.02) rotateX(-2deg)
    }

    100% {
      opacity: 1;
      transform: translateY(0) scale(1) rotateX(0)
    }
  }

  .msg.animate {
    animation: popIn .62s cubic-bezier(.2, .8, .2, 1)
  }

  /* reaction / hover toolbar */
  .msg-toolbar {
    position: absolute;
    top: -34px;
    left: 6px;
    display: flex;
    gap: 8px;
    opacity: 0;
    pointer-events: none;
    transform: translateY(-6px) scale(.96);
    transition: all .18s
  }

  .msg:hover .msg-toolbar {
    opacity: 1;
    pointer-events: auto;
    transform: translateY(0) scale(1)
  }

  .action-pill {
    background: rgba(255, 255, 255, 0.03);
    padding: 6px 8px;
    border-radius: 999px;
    border: 1px solid rgba(255, 255, 255, 0.02);
    font-size: .85rem
  }

  /* ---------- Input area ---------- */
  .chat-input-area {
    padding: 14px;
    border-top: 1px solid rgba(255, 255, 255, 0.02);
    display: flex;
    gap: 12px;
    align-items: center;
    background: linear-gradient(180deg, rgba(255, 255, 255, 0.01), rgba(255, 255, 255, 0.00));
  }

  #msgInput {
    flex: 1;
    padding: 12px 14px;
    border-radius: 12px;
    border: 1px solid rgba(232, 227, 227, 0.03);
    background: transparent;
    color: inherit;
    outline: none;
    font-size: 1rem;
    backdrop-filter: blur(4px);
    transition: box-shadow .18s, transform .12s;
    box-shadow: 0 6px 18px rgba(2, 6, 23, 0.45) inset;
  }

  #msgInput:focus {
    box-shadow: 0 12px 40px rgba(96, 165, 250, 0.06);
    transform: translateY(-2px)
  }

  .send-btn {
    border: 0;
    padding: 10px 14px;
    border-radius: 12px;
    background: linear-gradient(180deg, var(--accent), var(--accent-2));
    color: #04243e;
    font-weight: 700;
    cursor: pointer;
    display: inline-grid;
    place-items: center;
    transform-style: preserve-3d;
    transition: transform .18s, box-shadow .18s;
    box-shadow: 0 12px 30px rgba(96, 165, 250, 0.14);
  }

  .send-btn:hover {
    transform: translateY(-4px) translateZ(8px)
  }

  /* send pulse */
  .send-btn:active {
    transform: translateY(-2px)
  }

  /* typing indicator */
  .typing {
    display: inline-flex;
    gap: 6px;
    align-items: center;
    padding: 6px 10px;
    border-radius: 999px;
    background: rgba(255, 255, 255, 0.02);
  }

  .dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: #fff;
    opacity: .9;
    transform: scale(.8);
    animation: dotBounce 1s infinite ease-in-out
  }

  .dot:nth-child(2) {
    animation-delay: .12s
  }

  .dot:nth-child(3) {
    animation-delay: .24s
  }

  @keyframes dotBounce {
    0% {
      transform: translateY(0) scale(.85);
      opacity: .5
    }

    50% {
      transform: translateY(-6px) scale(1);
      opacity: 1
    }

    100% {
      transform: translateY(0) scale(.85);
      opacity: .6
    }
  }

  /* responsive */
  @media (max-width:560px) {
    .chat-shell {
      height: 100vh;
      border-radius: 0;
    }

    .messages {
      padding-bottom: 80px;
    }
  }